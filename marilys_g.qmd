---
title: "marilys_gfinal"
author: "Marilys Guiban"
format: html
editor: 
  markdown: 
    wrap: sentence
---

##Initialisation

```{r}
library(here)
library(ggplot2)
library(dplyr)
library(vroom)
library(tidyr)
install.packages("openxlsx")
library(openxlsx)
```

Sources : https://www.who.int/data/sets/health-inequality-monitor-dataset#mpi To download the data click on : "data and metadata".

### Loading the different files 

```{r}
WGI <- vroom("WGI.csv")
```

```{r}
Findex <- vroom("GlobalFindexDatabase2025.csv")
```

```{r}
empowerment <- vroom(here("women_inequalities.csv"))
```

With this code we

We will look at two datasets : - findex =\> indicator on financial inclusion - newfirm =\> dataset on new businesses between 2006 and 2022 - number of firms =\> same thing - world governance indicator : giving an idea of the confidence in institution We can keep the year 2021 for firms, new firms and findex.
Is financial inclusion correlated with less corruption and more political stability ?
If applicable does this implies that a country will have more new firms ?

## Dataset Findex

### Description of the dataset

### Tables describing the dataset

### Description of the sources

### Description of the variables

### Data cleaning

First we suppress the first line of our dataset since it is giving confusing informations. In order to do this we compute this code : 
```{r}
Findex <- Findex[-1, ]
```

Since there are a lot of different values, we are first calculating which are the 20 columns with the lowest number of missing values.

```{r}
na_count <- colSums(is.na(Findex))
na_count_sorted <- sort(na_count)
top15_colonnes <- names(na_count_sorted)[1:20]
top15_colonnes
```

The variables with the fewest missing values are those related to financial inclusion, such as receiving private-sector wages into a bank account (fin32.n33), borrowing money from family or friends (fin22b), making or receiving digital payments (g20.any), receiving public-sector wages into a bank account (fin32), saving money in a physical or online bank account (fin17a.17a1.d), borrowing to start a business (fin22e), and owning a bank account (fin2.t.d).
These variables represent key indicators of financial inclusion that we will observe closely.

For our project we are keeping the variables : 
- "has_bank_account" : The percentage of respondents who report being employed in the private sector and receiving any money from their employer in the past year in the form of a salary or wages for doing work, and who received that money directly into a bank or similar financial institution account 

- "borrow_start_business" : The percentage of respondents who report borrowing any money to start or operate a business in the past year.

- "save_bank_account" : The percentage of respondents who report saving or setting aside any money at a bank or similar financial institution or using a mobile money account to save in the past year.

- "digital payment" : The percentage of respondents who report using mobile money, a debit or credit card, or a mobile phone to make a payment from an account--or report using the internet to pay bills or to buy something online or in a store--in the past year. 
This includes respondents who report paying bills, sending or receiving remittances, receiving payments for agricultural products, receiving government transfers, receiving wages, or receiving a public sector pension directly from or into a bank or similar financial institution account or through a mobile money account in the past year.

- "borrow family_friends" : The percentage of respondents who report borrowing any money from family, relatives, or friends in the past year

With this code we are renaming and keeping only the values we are going to study in our project :

```{r}
Findex <- Findex %>%
  rename(
    borrow_family_friends     = fin22b,
    digital_payment           = g20.any,
    save_bank_account         = fin17a.17a1.d,
    borrow_start_business     = fin22e,
    has_bank_account          = fin2.t.d
  )
```

## Dataset World Government index

### Description of the dataset

### Tables describing the dataset

### Description of the sources

### Description of the variables

### Data cleaning

Again to identify what will be interesting to look at, we verify which variables have the lowest number of missing variables.
We will now keep the values for the years :

```{r}
na_count <- colSums(is.na(WGI))
na_count_sorted <- sort(na_count)
top15_colonnes <- names(na_count_sorted)[1:20]
top15_colonnes
```

Dans le dataset je regarde de quoi est composée la colonne 3 :

```{r}
unique(WGI$`Series Name`)
```

With pivot wider, we are sorting the data so and dividing our column Series Name in different columns for each variable that is studied.
The dataset named WGI_wide is the final dataset that we will use for our project.

```{r}
library(tidyr)

names(WGI) <- make.names(names(WGI), unique = TRUE)
dput(colnames(WGI))  # voir nouveaux noms


cols_annees <- grep("^X[0-9]{4}", colnames(WGI), value = TRUE)
cols_annees
library(dplyr)
library(tidyr)

WGI_long <- WGI %>%
  pivot_longer(
    cols = c(all_of(cols_annees), growth.rate),   # années + growth.rate
    names_to = "Annee",
    values_to = "Valeur"
  )

WGI_long <- WGI_long %>%
  mutate(Annee = gsub("X([0-9]{4}).*", "\\1", Annee))

WGI_wide <- WGI_long %>%
  pivot_wider(
    id_cols = c(Country.Name, Country.Code, Annee),
    names_from = Series.Name,
    values_from = Valeur
  )
```

Now let's determine which variable is the more relevant for our analysis For our research question and given the past variables that we have, we are using : - political stability and the absence of terrorism as an explicative variable of financial inclusion : - government effectiveness : Government Effectiveness captures perceptions of the quality of public services, the quality of the civil service and the degree of its independence from political pressures, the quality of policy formulation and implementation, and the credibility of the government's commitment to such policies.
Estimate gives the country's score on the aggregate indicator, in units of a standard normal distribution, i.e. ranging from approximately -2.5 to 2.5.

For the relevant years that we will certainly keep will be : 1999, 2009 (to see the effect of the Subprime crisis) and 2023 for the most recent data on world governmeent indexes.

Why is it relevant ?
Because when public services are functioning in a right way they allow the development of banks and financial institutions.

-   Rule of law : Rule of Law captures perceptions of the extent to which agents have confidence in and abide by the rules of society, and in particular the quality of contract enforcement, property rights, the police, and the courts, as well as the likelihood of crime and violence. Estimate gives the country's score on the aggregate indicator, in units of a standard normal distribution, i.e. ranging from approximately -2.5 to 2.5.

For all these variables we decided to keep - the estimate coefficient giving an idea of the importance of the variable - the percentile rank that is letting us know what is the performance of the country

Question : Can we observe a correlation between the quality of institutions, financial inclusion, and women’s ability to be independent in social and financial spheres?
Variables à expliquer : Women with high empowerment in the decision-making process and Women with high empowerment in the social domain.
(Data from the Women Empowerment dataset)

Main target variables : women with high empowerment in the decision making process, women with high empowerment in the social domain

Variables explicatives : - quality of institutions : we use political stability, absence of terrorism, and government effectiveness from the World Governance Indicators (WGI) to measure individuals’ confidence in their institutions.
- financial inclusion : whether the individual has a bank account, amount of savings per individual, borrowing (or not) from family, and receiving salary in a bank account.
Research question : Do the quality of institutions and the development of institutional financing systems enable women to empower themselves in the social and decision-making domains ?
- women's inclusion in the political sphere =\> through the

## Dataset V-Democracy :

In this dataset we will keep the women's political participation index through estimations for the years : 1999, 2009 and 2023. 
```{r}
womenpolitics <- read.csv(here("data", "womeninpolitics.csv"))
```

No cleaning was necessary for this dataset since we kept everything. 

How to download : click on this link https://www.v-dem.net/data/the-v-dem-dataset/country-year-v-dem-fullothers-v15/ Then download the dataset called "Country-Year: V-Dem Full+Others" On this dataset we did no specific clearing nor joining since it was complete and appeared well.

## Data joining 
We will now join our three datasets : 
 
 
## Description of our research question 

## Graphical representation of our two graphical representations 






